entryPoints:
  http:
    address: :80
    http:
      redirections:
        entryPoint:
          scheme: https
          to: https
  https:
    address: :443
    asDefault: true
    http3: {}
    transport:
      respondingTimeouts:
        readTimeout: 300


http:
  routers:
    immich:
      rule: Host(`immich.securitybits.io`)
      entrypoints: websecure
      service: service-immich
      tls:
        certresolver: letsencrypt
      middlewares:
        - limitBodySize@file
    microbin:
      rule: Host(`microbin.securitybits.io`)
      entrypoints: websecure
      service: service-microbin
      tls:
        certresolver: letsencrypt
  
  services:
    service-immich:
      loadBalancer:
        servers:
          - url: "http://10.0.50.125:2283"
    
    service-microbin:
      loadBalancer:
        servers:
          - url: "http://10.0.50.125:8080"

  middlewares:
    limitBodySize:
      buffering:
        maxRequestBodyBytes: 5000000000
    ip-whitelist:
      ipWhiteList:
        sourceRange:
          - "10.0.0.0/8"